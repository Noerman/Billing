<?phpnamespace App\AdminBundle\Helper;class CsvParser{    protected $container;    public function __construct($container)    {        $this->container = $container;    }    public function parseFile($fileName, $keywords, $validator, &$errors)    {        $delimiter = ';';        $fileHandle = fopen($fileName, 'r');        // Validate header        $lineHeader = fgets($fileHandle);        $headerTokens = explode($delimiter, $lineHeader);        $headers = array();        $i = 0;        foreach ($headerTokens as $token) {            $token = trim($token);            if (!in_array($token, $keywords)) {                $errors[] = "Don't accept header: " . $token . ", valid headers: [" . implode(', ', $keywords) . ']';                return false;            }            $headers[$i] = $token;            $i++;        }        // Proceed        $data = array();        while (($line = fgets($fileHandle)) !== false) {            $raw = explode($delimiter, $line);            $row = array();            $i = 0;            $msg = array();            foreach ($raw as $token) {                $token = trim($token);                $validator->validate($headers[$i], $token, $msg);                $row[$headers[$i]] = $token;                $i++;            }            if (empty($msg)) {                $row['message'] = 'OK';            } else {                $row['message'] = implode('<br/>', $msg);            }            $data[] = $row;        }        return $data;    }}