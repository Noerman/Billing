<?phpnamespace App\AdminBundle\Business\Client;use App\AdminBundle\Business;class ImportValidator{    public $container;    public function __construct($container)    {        $this->container = $container;    }    public $countries = array();    public $emails = array();    public function loadExisting($repository, $field)    {        $map = array();        $result = $this->container->get('doctrine')->getRepository($repository)->findAll();        $getMethod = 'get' . ucfirst($field);        foreach ($result as $r) {            $map[$r->$getMethod()] = 1;        }        return $map;    }    public function initialize()    {        $this->countries = $this->loadExisting('AppClientBundle:Country', 'name');        $this->emails = $this->loadExisting('AppUserBundle:User', 'email');    }    public function validate($field, $value, &$errors)    {        switch ($field) {            case 'email':                if (isset($this->emails[$value])) {                    $errors[] = 'Email ' . $value . ' already exists.';                }                break;            case 'country':                if (!isset($this->countries[$value])) {                    $errors[] = 'Country ' . $value . " don't exist";                }                break;        }    }}