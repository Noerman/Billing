<?phpnamespace App\AdminBundle\Business\Project;use App\AdminBundle\Business\Base\BaseDeleteHandler;use App\ClientBundle\Entity;class DeleteHandler extends BaseDeleteHandler{    public function execute()    {        $model = $this->getModel();        // Cascade through project attachments, tracking and tasks        $em = $this->container->get('doctrine')->getEntityManager();        $attachments = $em->getRepository('AppClientBundle:ClientProjectAttachment')->findByIdProject($model['id']);        $tasks = $em->getRepository('AppClientBundle:ClientProjectTask')->findByIdProject($model['id']);        $tracking = $em->getRepository('AppClientBundle:ClientProjectTracking')->findByIdProject($model['id']);        foreach($attachments as $attachment){            $files = $em->getRepository('AppClientBundle:ClientProjectAttachmentFile')->findByIdProjectAttachment($attachment->getId());            foreach($files as $file)            {                unlink($this->container->getParameter('project_upload_dir') . '/' . $file->getFile());                $em->remove($file);            }            $em->remove($attachment);        }        foreach($tasks as $task) $em->remove($task);        foreach($tracking as $track) $em->remove($track);        $em->flush();        // Delete the project        $this->helperDoctrine->deleteOneById('AppClientBundle:ClientProject', $model['id']);    }}